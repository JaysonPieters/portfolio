_Note: This is not all the code